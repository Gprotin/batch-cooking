<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Batch Cooking</title>
    <style>
        :root { --primary: #10b981; --bg: #f3f4f6; --card: #ffffff; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: #333; margin: 0; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        h1 { text-align: center; color: #064e3b; font-size: 1.5rem; }
        .card { background: var(--card); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 0.9rem;}
        .input-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .input-group div { flex: 1; }
        input { width: 100%; padding: 10px; box-sizing: border-box; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;}
        button { background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 8px; font-size: 1rem; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; }
        button.secondary { background: #6b7280; margin-top: 5px;}
        .hidden { display: none; }
        #exportSection { text-align: center; margin-top: 20px;}
        ul { padding-left: 20px; }
        li { margin-bottom: 8px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ü•ó Batch Cooking & Diet</h1>
    
    <div class="card">
        <h3>1. Ma Famille</h3>
        <div class="input-group">
            <div>
                <label>Adultes</label>
                <input type="number" id="nbAdults" value="2" min="1">
            </div>
            <div>
                <label>Enfants</label>
                <input type="number" id="nbKids" value="2" min="0">
            </div>
        </div>

        <label>Jours de menus :</label>
        <input type="number" id="daysCount" value="5" min="1" max="7">
        
        <button onclick="generateMenu()">G√©n√©rer ma semaine</button>
    </div>

    <div id="resultArea" class="hidden">
        <div class="card">
            <h3>üìÖ Menu</h3>
            <div id="menuOutput"></div>
        </div>

        <div class="card">
            <h3>üõí Liste de courses</h3>
            <div id="shoppingListOutput"></div>
        </div>

        <div id="exportSection">
            <button onclick="exportToNotes()">üì§ Exporter vers Apple Notes</button>
        </div>
    </div>
</div>

<script>
    /** * BASE DE DONN√âES (JSON)
     * Modifiez directement cette liste pour ajouter/supprimer vos recettes.
     */
    const recipesDB = [
        {
            "id": 1,
            "nom": "Bolognaise de B≈ìuf 5% (L√©gumes cach√©s)",
            "nb_personnes_base": 4,
            "ingredients": [
                {"nom": "Boeuf hach√© 5%", "quantite": 500, "unite": "g"},
                {"nom": "Spaghetti complets", "quantite": 400, "unite": "g"},
                {"nom": "Carottes", "quantite": 3, "unite": "pi√®ces"},
                {"nom": "Coulis de tomate", "quantite": 500, "unite": "ml"}
            ]
        },
        {
            "id": 2,
            "nom": "Dahl de Lentilles Corail",
            "nb_personnes_base": 4,
            "ingredients": [
                {"nom": "Lentilles corail", "quantite": 300, "unite": "g"},
                {"nom": "Lait de coco light", "quantite": 400, "unite": "ml"},
                {"nom": "Riz basmati", "quantite": 250, "unite": "g"}
            ]
        },
        {
            "id": 3,
            "nom": "Frittata Brocolis & Pommes de terre",
            "nb_personnes_base": 4,
            "ingredients": [
                {"nom": "Oeufs", "quantite": 8, "unite": "pi√®ces"},
                {"nom": "Pommes de terre", "quantite": 500, "unite": "g"},
                {"nom": "Brocolis", "quantite": 1, "unite": "t√™te"}
            ]
        }
        [
  { "id": 6, "nom": "Lasagnes √† la Bolognaise et Carottes", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Boeuf hach√© 5%", "quantite": 500, "unite": "g"}, {"nom": "P√¢tes √† lasagnes", "quantite": 250, "unite": "g"}, {"nom": "Carottes", "quantite": 4, "unite": "pi√®ces"}, {"nom": "Coulis de tomate", "quantite": 600, "unite": "ml"}, {"nom": "B√©chamel l√©g√®re", "quantite": 400, "unite": "ml"}
  ]},
  { "id": 7, "nom": "Boulettes de Boeuf au Fromage et Tomate", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Boeuf hach√© 5%", "quantite": 600, "unite": "g"}, {"nom": "Mozzarella r√¢p√©e", "quantite": 100, "unite": "g"}, {"nom": "Pur√©e de tomate", "quantite": 400, "unite": "ml"}, {"nom": "Riz complet", "quantite": 250, "unite": "g"}
  ]},
  { "id": 8, "nom": "Gratin de P√¢tes au Jambon de Boeuf et Brocolis", "nb_personnes_base": 4, "ingredients": [
      {"nom": "P√¢tes compl√®tes", "quantite": 400, "unite": "g"}, {"nom": "D√©s de jambon de boeuf", "quantite": 200, "unite": "g"}, {"nom": "Brocolis", "quantite": 600, "unite": "g"}, {"nom": "Cr√®me l√©g√®re 12%", "quantite": 200, "unite": "ml"}
  ]},
  { "id": 9, "nom": "Shepherd's Pie (Hachis Parmentier) Doux", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Boeuf hach√© 5%", "quantite": 500, "unite": "g"}, {"nom": "Pommes de terre", "quantite": 800, "unite": "g"}, {"nom": "Petits pois", "quantite": 200, "unite": "g"}, {"nom": "Lait demi-√©cr√©m√©", "quantite": 150, "unite": "ml"}
  ]},
  { "id": 10, "nom": "Riz Cantonais au Boeuf (Sain)", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Riz basmati cuit", "quantite": 600, "unite": "g"}, {"nom": "Oeufs", "quantite": 4, "unite": "pi√®ces"}, {"nom": "Petits pois", "quantite": 150, "unite": "g"}, {"nom": "Steak hach√© coup√© en d√©s", "quantite": 400, "unite": "g"}
  ]},
  { "id": 11, "nom": "Lentilles Saucisses de Boeuf Express", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Lentilles vertes", "quantite": 300, "unite": "g"}, {"nom": "Saucisses de boeuf", "quantite": 4, "unite": "pi√®ces"}, {"nom": "Carottes", "quantite": 3, "unite": "pi√®ces"}, {"nom": "Oignon", "quantite": 1, "unite": "pi√®ce"}
  ]},
  { "id": 12, "nom": "Quiche sans P√¢te aux Poireaux et Bacon de Boeuf", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Oeufs", "quantite": 5, "unite": "pi√®ces"}, {"nom": "Poireaux", "quantite": 3, "unite": "pi√®ces"}, {"nom": "Bacon de boeuf", "quantite": 100, "unite": "g"}, {"nom": "Lait", "quantite": 250, "unite": "ml"}, {"nom": "Farine", "quantite": 80, "unite": "g"}
  ]},
  { "id": 13, "nom": "Moussaka L√©g√®re (Boeuf & Aubergines)", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Boeuf hach√© 5%", "quantite": 500, "unite": "g"}, {"nom": "Aubergines", "quantite": 3, "unite": "pi√®ces"}, {"nom": "Tomates concass√©es", "quantite": 400, "unite": "g"}, {"nom": "Yaourt grec (pour le nappage)", "quantite": 200, "unite": "g"}
  ]},
  { "id": 14, "nom": "Saut√© de Porc (Filet Mignon) aux Pommes", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Filet mignon de porc", "quantite": 600, "unite": "g"}, {"nom": "Pommes", "quantite": 3, "unite": "pi√®ces"}, {"nom": "Pommes de terre", "quantite": 400, "unite": "g"}, {"nom": "Oignon", "quantite": 1, "unite": "pi√®ce"}
  ]},
  { "id": 15, "nom": "Curry de Pois Chiches Doux au Lait de Coco", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Pois chiches cuits", "quantite": 500, "unite": "g"}, {"nom": "Lait de coco light", "quantite": 400, "unite": "ml"}, {"nom": "Epinards frais", "quantite": 200, "unite": "g"}, {"nom": "Quinoa", "quantite": 200, "unite": "g"}
  ]},
  { "id": 16, "nom": "P√¢tes √† la Cr√®me de Potiron et Parmesan", "nb_personnes_base": 4, "ingredients": [
      {"nom": "P√¢tes compl√®tes", "quantite": 400, "unite": "g"}, {"nom": "Pur√©e de potiron", "quantite": 400, "unite": "g"}, {"nom": "Parmesan", "quantite": 50, "unite": "g"}, {"nom": "Lait", "quantite": 100, "unite": "ml"}
  ]},
  { "id": 17, "nom": "Muffins aux Oeufs, L√©gumes et Emmental", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Oeufs", "quantite": 8, "unite": "pi√®ces"}, {"nom": "Courgettes r√¢p√©es", "quantite": 2, "unite": "pi√®ces"}, {"nom": "Emmental r√¢p√©", "quantite": 60, "unite": "g"}, {"nom": "Tranches de pain complet", "quantite": 4, "unite": "pi√®ces"}
  ]},
  { "id": 18, "nom": "Tacos Doux au Boeuf et Ma√Øs", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Tortillas de bl√© complet", "quantite": 8, "unite": "pi√®ces"}, {"nom": "Boeuf hach√© 5%", "quantite": 400, "unite": "g"}, {"nom": "Ma√Øs", "quantite": 150, "unite": "g"}, {"nom": "Tomates", "quantite": 2, "unite": "pi√®ces"}
  ]},
  { "id": 19, "nom": "Risotto aux Champignons et Porc Maigre", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Riz √† risotto", "quantite": 300, "unite": "g"}, {"nom": "Champignons de Paris", "quantite": 400, "unite": "g"}, {"nom": "D√©s de porc (filet)", "quantite": 400, "unite": "g"}, {"nom": "Bouillon de l√©gumes", "quantite": 1, "unite": "litre"}
  ]},
  { "id": 20, "nom": "Omelette Roul√©e au Fromage et Salade", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Oeufs", "quantite": 10, "unite": "pi√®ces"}, {"nom": "Fromage frais type St-Moret", "quantite": 150, "unite": "g"}, {"nom": "Salade verte", "quantite": 1, "unite": "pi√®ce"}, {"nom": "Pommes de terre vapeur", "quantite": 400, "unite": "g"}
  ]},
  { "id": 21, "nom": "Boulettes de Lentilles au Coulis de Tomate", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Lentilles cuites", "quantite": 400, "unite": "g"}, {"nom": "Chapelure", "quantite": 50, "unite": "g"}, {"nom": "Coulis de tomate", "quantite": 400, "unite": "ml"}, {"nom": "Spaghetti", "quantite": 300, "unite": "g"}
  ]},
  { "id": 22, "nom": "Gratin de Chou-fleur au Jambon de Boeuf", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Chou-fleur", "quantite": 1, "unite": "pi√®ce"}, {"nom": "D√©s de jambon de boeuf", "quantite": 200, "unite": "g"}, {"nom": "Lait", "quantite": 400, "unite": "ml"}, {"nom": "Ma√Øzena", "quantite": 30, "unite": "g"}
  ]},
  { "id": 23, "nom": "Chili V√©g√©tarien (Sin Carne)", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Haricots rouges", "quantite": 500, "unite": "g"}, {"nom": "Ma√Øs", "quantite": 150, "unite": "g"}, {"nom": "Poivrons", "quantite": 2, "unite": "pi√®ces"}, {"nom": "Riz complet", "quantite": 250, "unite": "g"}, {"nom": "Pulpe de tomate", "quantite": 400, "unite": "ml"}
  ]},
  { "id": 24, "nom": "Fajitas au Boeuf et Poivrons Doux", "nb_personnes_base": 4, "ingredients": [
      {"nom": "Bifteck coup√© en lani√®res", "quantite": 500, "unite": "g"}, {"nom": "Tortillas", "quantite": 8, "unite": "pi√®ces"}, {"nom": "Poivrons tricolores", "quantite": 3, "unite": "pi√®ces"}, {"nom": "Oignon rouge", "quantite": 1, "unite": "pi√®ce"}
  ]},
  { "id": 25, "nom": "One Pot Pasta Boeuf et Courgettes", "nb_personnes_base": 4, "ingredients": [
      {"nom": "P√¢tes", "quantite": 350, "unite": "g"}, {"nom": "Boeuf hach√©", "quantite": 400, "unite": "g"}, {"nom": "Courgettes", "quantite": 2, "unite": "pi√®ces"}, {"nom": "Tomates cerises", "quantite": 200, "unite": "g"}
  ]}
]
    ];

    const KID_RATIO = 0.5;

    function generateMenu() {
        const days = parseInt(document.getElementById('daysCount').value);
        const adults = parseInt(document.getElementById('nbAdults').value) || 0;
        const kids = parseInt(document.getElementById('nbKids').value) || 0;
        const totalParts = adults + (kids * KID_RATIO);

        const shuffled = [...recipesDB].sort(() => 0.5 - Math.random());
        const selectedMenu = shuffled.slice(0, Math.min(days, recipesDB.length));
        
        displayMenu(selectedMenu);
        calculateShopping(selectedMenu, totalParts);
        document.getElementById('resultArea').classList.remove('hidden');
    }

    function displayMenu(menu) {
        let html = "<ul>";
        window.currentMenuText = "";
        menu.forEach((recipe, i) => {
            html += `<li><strong>J${i+1}:</strong> ${recipe.nom}</li>`;
            window.currentMenuText += `J${i+1}: ${recipe.nom}\n`;
        });
        html += "</ul>";
        document.getElementById('menuOutput').innerHTML = html;
    }

    function calculateShopping(menu, totalPartsNeeded) {
        let ingredientsMap = {};
        menu.forEach(recipe => {
            const ratio = totalPartsNeeded / (recipe.nb_personnes_base || 4);
            recipe.ingredients.forEach(ing => {
                let key = ing.nom.toLowerCase() + "_" + ing.unite;
                if (!ingredientsMap[key]) {
                    ingredientsMap[key] = { name: ing.nom, qty: 0, unit: ing.unite };
                }
                ingredientsMap[key].qty += (ing.quantite * ratio);
            });
        });

        let html = "<ul>";
        window.currentShoppingText = "";
        Object.values(ingredientsMap).sort((a,b) => a.name.localeCompare(b.name)).forEach(item => {
            let displayQty = ['g','ml'].includes(item.unit.toLowerCase()) ? Math.ceil(item.qty) : item.qty.toFixed(1);
            let line = `${item.name}: ${displayQty} ${item.unit}`;
            html += `<li>${line}</li>`;
            window.currentShoppingText += `- [ ] ${line}\n`;
        });
        document.getElementById('shoppingListOutput').innerHTML = html + "</ul>";
    }

    async function exportToNotes() {
        const text = `üçé MON BATCH COOKING\n\nMENU :\n${window.currentMenuText}\nCOURSES :\n${window.currentShoppingText}`;
        if (navigator.share) {
            try { await navigator.share({ title: "Liste Courses", text: text }); } catch (e) {}
        } else {
            navigator.clipboard.writeText(text);
            alert("Copi√© dans le presse-papier !");
        }
    }
</script>
</body>
</html>
